<!DOCTYPE html>

<html>
<head>
  <title>Loft Core: Users</title>
  <link href="search/tipuesearch.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>

<body class="page--loft_core_users">
<header>
  <div class="pager">
  <a href="images.html" class="prev images">&laquo;Images</a>
  <a href="index.html" class="index">Index</a>
  <a href="redirects.html" class="next redirects">Redirects&raquo;</a>
</div>
</header>

  <div class="search__wrapper">
  <form action="search--results.html">
    <input type="text" class="search-input" name="q" id="tipue_search_input" autocomplete="off" required>
  </form>
</div>

  <h1>Loft Core: Users</h1>
  <div class="breadcrumb"><a href="index.html">Index</a></div>

<section>

<p>Authenticated users are tracked by their uid; no surprise here.</p>

<h2>About anonymous users</h2>

<p>Anonymous users are unique by the domain of their email address + their ip.  That is to say that for these three users, only one record will be created (tracked):</p>

<p>| uid | mail | ip |
|----------|----------|----------|
0 | a@spammy.com | 172.1.1.1
0 | b@spammy.com | 172.1.1.1
0 | c@spammy.com | 172.1.1.1</p>

<p>This is because all email address share the same domain and the ip is the same from all three.</p>

<p>But in this next set, three entries would be made because the ip is different for two and non-existent for one, despite having the same base domain.</p>

<p>| uid | mail | ip |
|----------|----------|----------|
0 | a@spammy.com | 172.1.1.1
0 | b@spammy.com | 172.1.1.2
0 | c@spammy.com | null</p>

<p>Also take note that if the ip is the same but the domain differs, then three records will be tracked:</p>

<p>| uid | mail | ip |
|----------|----------|----------|
0 | trouble@spammy.com | 172.1.1.1
0 | trouble@morespam.com | 172.1.1.1
0 | trouble@totalspam.com | 172.1.1.1</p>

<p><strong>To save database, we don't track anonymous users by email address, but by email domain, as this is the most likely reason to track them: <em>to block their entire domain.</em></strong></p>

<h2>Suggested modules to use:</h2>

<h3><a href="https://www.drupal.org/project/honeypot">Honeypot</a></h3>

<p>Honeypot rejections will be tracked as "honey bears" and can later be converted to "spammy" users.  This only works if the <code>$_POST</code> array contains the key <code>mail</code>.  An example is <code>user_register_form</code>, where this works nicely.  Honeybears can be found in the table <code>loft_core_users</code> with a status of <code>LOFT_CORE_USERS_STATUS_HONEYBEAR</code>.</p>

<h3><a href="https://www.drupal.org/project/user_restrictions">User Restrictions</a></h3>

<p>Blocks users with an email address containing any domains that have been found as "spammy".  The list of domains are found in <code>loft_core_users</code>.  Check the status because honeybear domains do not block new users.</p>

<h2>Todos</h2>

<ul>
<li>[] batch process to mark all users that match domains or ips in our loft_users_core.</li>
<li>[] automatically add to <code>blocked_ips</code> table.</li>
</ul>
</section>

<div class="search__results">
  <div id="tipue_search_content"></div>
</div>

<footer>
  <div class="pager">
  <a href="images.html" class="prev images">&laquo;Images</a>
  <a href="index.html" class="index">Index</a>
  <a href="redirects.html" class="next redirects">Redirects&raquo;</a>
</div>
  
  <div id="footer-legaleeze">
    <p class="legaleeze center">Version: 7.x-0.3-rc42 &bull; Last Updated: Sat, 28 Apr 2018 10:23:40 -0700</p>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="search/tipuesearch_content.js"></script>
  <script src="search/tipuesearch_set.js"></script>
  <script src="search/tipuesearch.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#tipue_search_input').tipuesearch();
    });
  </script>
<script src="js/core.js"></script>
</body>
</html>

